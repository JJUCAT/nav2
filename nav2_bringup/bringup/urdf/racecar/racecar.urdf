<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from racecar.xacro                  | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<!-- racecar.urdf.xacro

This file defines a model of a Traxxas(R) E-Maxx(R) #3905 RC (Radio Controlled)
truck.

Lengths are measured in meters, angles are measured in radians, and masses are
measured in kilograms. All of these values are approximations.

To work with Gazebo, each link must have an inertial element, even if
the link only serves to connect two joints. To be visible in Gazebo, a link
must have a collision element. Furthermore, the link must have a Gazebo
material.

Traxxas(R), E-Maxx(R), and Titan(R) are registered trademarks of Traxxas
Management, LLC. em_3905.urdf.xacro was independently created by Wunderkammer
Laboratory, and neither em_3905.urdf.xacro nor Wunderkammer Laboratory is
affiliated with, sponsored by, approved by, or endorsed by Traxxas Management,
LLC. Mabuchi Motor(R) is a registered trademark of Mabuchi Motor Co., Ltd.
Corporation Japan. All other trademarks and service marks are the property of
their respective owners.

Copyright (c) 2011-2014 Wunderkammer Laboratory

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<robot name="racecar">
  <link name="camera_link">
    <inertial>
      <mass value="0.001"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
    </inertial>
    <visual>
      <origin rpy="1.57 0 1.57" xyz=" 0 0 0 "/>
      <geometry>
        <mesh filename="package://nav2_bringup/meshes/racecar/S1030-0315.dae" scale="0.1 0.1 0.1"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.03 0.16 0.03"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="camera_link">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="camera_link">
    <sensor name="camera_node" type="camera">
      <pose>0 0 0 0 0 0</pose>
      <update_rate>30.0</update_rate>
      <camera name="head">
        <horizontal_fov>1.3962634</horizontal_fov>
        <image>
          <width>1280</width>
          <height>720</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.02</near>
          <far>300</far>
        </clip>
        <noise>
          <type>gaussian</type>
          <mean>0.0</mean>
          <stddev>0.007</stddev>
        </noise>
      </camera>
      <plugin filename="libgazebo_ros_camera.so" name="gazebo_camera">
        <alwaysOn>true</alwaysOn>
        <updateRate>0.0</updateRate>
        <cameraName>/camera</cameraName>
        <imageTopicName>image_raw</imageTopicName>
        <cameraInfoTopicName>camera_info</cameraInfoTopicName>
        <frameName>camera_link</frameName>
        <hackBaseline>0.07</hackBaseline>
        <distortionK1>0.0</distortionK1>
        <distortionK2>0.0</distortionK2>
        <distortionK3>0.0</distortionK3>
        <distortionT1>0.0</distortionT1>
        <distortionT2>0.0</distortionT2>
      </plugin>
    </sensor>
  </gazebo>
  <material name="battery_mat">
    <color rgba="0 0 1 1"/>
  </material>
  <material name="chassis_mat">
    <color rgba="0.5 0.5 0.5 1"/>
  </material>
  <material name="tire_mat">
    <color rgba="0 0 0 1"/>
  </material>
  <material name="yellow">
    <color rgba="1 0.4 0 1"/>
  </material>
  <link name="base_footprint"/>
  <!-- base_link must have geometry so that its axes can be displayed in
       rviz. -->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="0.01 0.01 0.01"/>
      </geometry>
      <material name="chassis_mat"/>
    </visual>
  </link>
  <gazebo reference="base_link">
    <material>Gazebo/Grey</material>
  </gazebo>
  <joint name="base_footprint_to_base_link" type="fixed">
    <parent link="base_footprint"/>
    <child link="base_link"/>
    <origin xyz="0 0 0.10750000000000001"/>
  </joint>
  <!-- Chassis -->
  <link name="chassis">
    <visual>
      <origin xyz="0 0 -0.005"/>
      <geometry>
        <box size="0.258 0.168 0.01"/>
      </geometry>
      <material name="chassis_mat"/>
    </visual>
    <collision>
      <origin xyz="0 0 -0.005"/>
      <geometry>
        <box size="0.258 0.168 0.01"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 -0.005"/>
      <mass value="2.788"/>
      <inertia ixx="0.0065806093333333334" ixy="0" ixz="0" iyy="0.015488269333333332" iyz="0" izz="0.022022411999999995"/>
    </inertial>
  </link>
  <gazebo reference="chassis">
    <material>Gazebo/Grey</material>
  </gazebo>
  <joint name="base_link_to_chassis" type="fixed">
    <parent link="base_link"/>
    <child link="chassis"/>
  </joint>
  <joint name="chassis_to_left_battery" type="fixed">
    <parent link="chassis"/>
    <child link="left_battery_offset"/>
    <origin rpy="0.34906585 0 0" xyz="-0.025                    0.0325                    0"/>
  </joint>
  <link name="left_battery_offset">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="offset_to_left_battery" type="fixed">
    <parent link="left_battery_offset"/>
    <child link="left_battery"/>
    <origin xyz="0                    0.0235                    -0.008"/>
  </joint>
  <link name="left_battery">
    <visual>
      <geometry>
        <box size="0.16 0.047 0.024"/>
      </geometry>
      <material name="battery_mat"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.16 0.047 0.024"/>
      </geometry>
    </collision>
    <inertial>
      <origin/>
      <mass value="0.5025"/>
      <inertia ixx="0.000116621875" ixy="0" ixz="0" iyy="0.00109612" iyz="0" izz="0.0011645018749999998"/>
    </inertial>
  </link>
  <gazebo reference="left_battery">
    <material>Gazebo/Blue</material>
  </gazebo>
  <joint name="chassis_to_right_battery" type="fixed">
    <parent link="chassis"/>
    <child link="right_battery_offset"/>
    <origin rpy="-0.34906585 0 0" xyz="-0.025                    -0.0325                    0"/>
  </joint>
  <link name="right_battery_offset">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="offset_to_right_battery" type="fixed">
    <parent link="right_battery_offset"/>
    <child link="right_battery"/>
    <origin xyz="0                    -0.0235                    -0.008"/>
  </joint>
  <link name="right_battery">
    <visual>
      <geometry>
        <box size="0.16 0.047 0.024"/>
      </geometry>
      <material name="battery_mat"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.16 0.047 0.024"/>
      </geometry>
    </collision>
    <inertial>
      <origin/>
      <mass value="0.5025"/>
      <inertia ixx="0.000116621875" ixy="0" ixz="0" iyy="0.00109612" iyz="0" izz="0.0011645018749999998"/>
    </inertial>
  </link>
  <gazebo reference="right_battery">
    <material>Gazebo/Blue</material>
  </gazebo>
  <link name="left_steering_link">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="left_front_w_joint" type="fixed">
    <parent link="chassis"/>
    <child link="left_steering_link"/>
    <origin rpy="0 0 0" xyz="0.1675                    0.1525                    -0.0235"/>
  </joint>
  <joint name="left_steering_joint" type="revolute">
    <parent link="left_steering_link"/>
    <child link="left_front_axle_carrier"/>
    <axis xyz="0 0 1"/>
    <limit effort="0.5649" lower="-0.785398163" upper="0.785398163" velocity="4.553"/>
  </joint>
  <link name="left_front_axle_carrier">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- The left and right axles have the same axis so that identical
         rotation values cause the wheels to rotate in the same direction. -->
  <joint name="left_front_axle" type="continuous">
    <parent link="left_front_axle_carrier"/>
    <child link="left_front_wheel"/>
    <origin rpy="1.57079633 0 0"/>
    <axis xyz="0 0 -1"/>
    <limit effort="5.12766" velocity="244.8696"/>
  </joint>
  <link name="left_front_wheel">
    <visual>
      <origin xyz="0                      -6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin xyz="0                      -6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.29"/>
      <inertia ixx="0.0007464659129791666" ixy="0" ixz="0" iyy="0.0007464659129791666" iyz="0" izz="0.001110943342625"/>
    </inertial>
  </link>
  <gazebo reference="left_front_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  <link name="right_steering_link">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="right_front_w_joint" type="fixed">
    <parent link="chassis"/>
    <child link="right_steering_link"/>
    <origin rpy="0 0 0" xyz="0.1675                    -0.1525                    -0.0235"/>
  </joint>
  <joint name="right_steering_joint" type="revolute">
    <parent link="right_steering_link"/>
    <child link="right_front_axle_carrier"/>
    <axis xyz="0 0 1"/>
    <limit effort="0.5649" lower="-0.785398163" upper="0.785398163" velocity="4.553"/>
  </joint>
  <link name="right_front_axle_carrier">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- The left and right axles have the same axis so that identical
         rotation values cause the wheels to rotate in the same direction. -->
  <joint name="right_front_axle" type="continuous">
    <parent link="right_front_axle_carrier"/>
    <child link="right_front_wheel"/>
    <origin rpy="1.57079633 0 0"/>
    <axis xyz="0 0 -1"/>
    <limit effort="5.12766" velocity="244.8696"/>
  </joint>
  <link name="right_front_wheel">
    <visual>
      <origin xyz="0                      6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin xyz="0                      6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.29"/>
      <inertia ixx="0.0007464659129791666" ixy="0" ixz="0" iyy="0.0007464659129791666" iyz="0" izz="0.001110943342625"/>
    </inertial>
  </link>
  <gazebo reference="right_front_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  <link name="left_rear_axle_carrier">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- The left and right axles have the same axis so that identical
         rotation values cause the wheels to rotate in the same direction. -->
  <joint name="left_rear_axle" type="continuous">
    <parent link="left_rear_axle_carrier"/>
    <child link="left_rear_wheel"/>
    <origin rpy="1.57079633 0 0"/>
    <axis xyz="0 0 -1"/>
    <limit effort="5.12766" velocity="244.8696"/>
  </joint>
  <link name="left_rear_wheel">
    <visual>
      <origin xyz="0                      -6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin xyz="0                      -6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.29"/>
      <inertia ixx="0.0007464659129791666" ixy="0" ixz="0" iyy="0.0007464659129791666" iyz="0" izz="0.001110943342625"/>
    </inertial>
  </link>
  <gazebo reference="left_rear_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  <joint name="left_rear_w_joint" type="fixed">
    <parent link="chassis"/>
    <child link="left_rear_axle_carrier"/>
    <origin rpy="0 0 0" xyz="-0.1675                    0.1525                    -0.0235"/>
  </joint>
  <link name="right_rear_axle_carrier">
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- The left and right axles have the same axis so that identical
         rotation values cause the wheels to rotate in the same direction. -->
  <joint name="right_rear_axle" type="continuous">
    <parent link="right_rear_axle_carrier"/>
    <child link="right_rear_wheel"/>
    <origin rpy="1.57079633 0 0"/>
    <axis xyz="0 0 -1"/>
    <limit effort="5.12766" velocity="244.8696"/>
  </joint>
  <link name="right_rear_wheel">
    <visual>
      <origin xyz="0                      6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin xyz="0                      6.938893903907228e-18                      0"/>
      <geometry>
        <cylinder length="0.0889" radius="0.073025"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.29"/>
      <inertia ixx="0.0007464659129791666" ixy="0" ixz="0" iyy="0.0007464659129791666" iyz="0" izz="0.001110943342625"/>
    </inertial>
  </link>
  <gazebo reference="right_rear_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  <joint name="right_rear_w_joint" type="fixed">
    <parent link="chassis"/>
    <child link="right_rear_axle_carrier"/>
    <origin rpy="0 0 0" xyz="-0.1675                    -0.1525                    -0.0235"/>
  </joint>
  <plugin filename="libgazebo_ros_ackermann_drive.so" name="gazebo_ros_ackermann_drive">
    <ros>
      <!-- <namespace>demo</namespace>
      <remapping>cmd_vel:=cmd_demo</remapping>
      <remapping>odom:=odom_demo</remapping>
      <remapping>distance:=distance_demo</remapping> -->
    </ros>
    <update_rate>30.0</update_rate>
    <!-- wheels -->
    <front_left_joint>left_front_axle</front_left_joint>
    <front_right_joint>right_front_axle</front_right_joint>
    <rear_left_joint>left_rear_axle</rear_left_joint>
    <rear_right_joint>right_rear_axle</rear_right_joint>
    <left_steering_joint>left_steering_joint</left_steering_joint>
    <right_steering_joint>right_steering_joint</right_steering_joint>
    <!-- <steering_wheel_joint>steering_joint</steering_wheel_joint> -->
    <!-- Max absolute steer angle for tyre in radians-->
    <!-- Any cmd_vel angular z greater than this would be capped -->
    <max_steer>0.6458</max_steer>
    <!-- Max absolute steering angle of steering wheel -->
    <max_steering_angle>7.85</max_steering_angle>
    <!-- Max absolute linear speed in m/s -->
    <max_speed>1.2</max_speed>
    <!-- PID tuning -->
    <left_steering_pid_gain>1500 0 1</left_steering_pid_gain>
    <left_steering_i_range>0 0</left_steering_i_range>
    <right_steering_pid_gain>1500 0 1</right_steering_pid_gain>
    <right_steering_i_range>0 0</right_steering_i_range>
    <linear_velocity_pid_gain>1000 0 1</linear_velocity_pid_gain>
    <linear_velocity_i_range>0 0</linear_velocity_i_range>
    <!-- output -->
    <publish_odom>true</publish_odom>
    <publish_odom_tf>true</publish_odom_tf>
    <publish_wheel_tf>true</publish_wheel_tf>
    <publish_distance>true</publish_distance>
    <odometry_frame>odom</odometry_frame>
    <robot_base_frame>base_footprint</robot_base_frame>
  </plugin>
  <joint name="platform_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0.08"/>
    <parent link="chassis"/>
    <child link="platform_link"/>
  </joint>
  <link name="platform_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.4 0.18 0.01"/>
      </geometry>
      <material name="yellow"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.4 0.18 0.01"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 -0.005"/>
      <mass value="0.0"/>
      <inertia ixx="0.0" ixy="0" ixz="0" iyy="0.0" iyz="0" izz="0.0"/>
    </inertial>
  </link>
  <gazebo reference="platform_link">
    <material>Gazebo/Orange</material>
  </gazebo>
  <joint name="lidar_platform_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.08 0 0.08"/>
    <parent link="platform_link"/>
    <child link="lidar_platform_link"/>
  </joint>
  <link name="lidar_platform_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.12 0.1 0.01"/>
      </geometry>
      <material name="yellow"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.12 0.1 0.01"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 -0.005"/>
      <mass value="0.0"/>
      <inertia ixx="0.0" ixy="0" ixz="0" iyy="0.0" iyz="0" izz="0.0"/>
    </inertial>
  </link>
  <gazebo reference="lidar_platform_link">
    <material>Gazebo/Orange</material>
  </gazebo>
  <joint name="lidar_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0.03"/>
    <parent link="lidar_platform_link"/>
    <child link="laser_link"/>
  </joint>
  <!-- Create laser reference frame -->
  <link name="laser_link">
    <inertial>
      <mass value="0.001"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz=" 0 0 0 "/>
      <geometry>
        <cylinder length="0.05" radius="0.05"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <cylinder length="0.06" radius="0.05"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="laser_link">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="laser_link">
    <sensor name="ls01g" type="ray">
      <pose>0 0 0 0 0 0</pose>
      <visualize>false</visualize>
      <update_rate>10.0</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>360</samples>
            <resolution>1</resolution>
            <min_angle>-3.1415926</min_angle>
            <max_angle>3.1415926</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.10</min>
          <max>8.0</max>
          <resolution>0.01</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
      <plugin filename="libgazebo_ros_laser.so" name="gazebo_ls01g">
        <topicName>/scan</topicName>
        <frameName>laser_link</frameName>
      </plugin>
    </sensor>
  </gazebo>
  <joint name="imu_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.16 0 0.015"/>
    <parent link="platform_link"/>
    <child link="imu_link"/>
  </joint>
  <!-- Create laser reference frame -->
  <link name="imu_link">
    <inertial>
      <mass value="0.001"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz=" 0 0 0 "/>
      <geometry>
        <box size="0.04 0.04 0.03"/>
      </geometry>
      <material name="black"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.04 0.04 0.03"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="imu_link">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="imu_link">
    <gravity>true</gravity>
    <sensor name="imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>100</update_rate>
      <visualize>true</visualize>
      <topic>/imu_data</topic>
      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">
        <topicName>/imu_data</topicName>
        <bodyName>imu_link</bodyName>
        <updateRateHZ>100.0</updateRateHZ>
        <gaussianNoise>0.0</gaussianNoise>
        <xyzOffset>0 0 0</xyzOffset>
        <rpyOffset>0 0 0</rpyOffset>
        <frameName>imu_link</frameName>
      </plugin>
      <pose>0 0 0 0 0 0</pose>
    </sensor>
  </gazebo>
  <joint name="camera_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.16 0 0.05"/>
    <parent link="platform_link"/>
    <child link="camera_link"/>
  </joint>
  <camera prefix="camera"/>
</robot>
